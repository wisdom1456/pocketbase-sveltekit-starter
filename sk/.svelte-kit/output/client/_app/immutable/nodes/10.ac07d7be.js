import{c as je,g as ft,e as lt,u as dt,d as mt}from"../chunks/index.23ea4071.js";import"../chunks/singletons.74ef3276.js";import{s as gt,C as ht,o as _t,f as u,g as c,h,d,j as s,i as te,u as A,E as Ie,a as v,l as Be,c as b,m as Ue,L as at,v as r,Q as z,w as ee,R as vt,n as Ge,A as bt,e as st}from"../chunks/scheduler.c76fa77e.js";import{S as yt,i as Et,b as it,d as ut,m as ct,a as Te,t as we,e as pt,g as It,c as Tt}from"../chunks/index.315486b9.js";import{p as wt}from"../chunks/stores.a912c413.js";import{b as kt,u as rt}from"../chunks/postService.2a4ca333.js";import{S as Ct}from"../chunks/SvelteMarkdown.ba0f761d.js";import{e as xt,g as Ee,p as Lt,b as Pt,t as St,c as Dt,d as Mt}from"../chunks/api.ff6b22b1.js";import{L as At}from"../chunks/LoginGuard.4ed2dc58.js";const Vt=async function({params:n}){const{slug:l}=n;try{const{items:a}=await je.collection("posts").getList(void 0,void 0,{filter:`slug='${l}'`});if(a.length===0)throw new Error("Post not found");const t=a[0];let i="";if(t.featuredImage){const e=await je.collection("images").getOne(t.featuredImage);e&&e.file&&(i=je.getFileUrl(e,e.file))}return{post:t,featuredImageUrl:i}}catch(a){throw console.error("Error fetching post:",a),a}},Kt=Object.freeze(Object.defineProperty({__proto__:null,load:Vt},Symbol.toStringTag,{value:"Module"}));function ot(n,l,a){const t=n.slice();return t[12]=l[a],t}function Ht(n){let l,a="Loading post...";return{c(){l=u("p"),l.textContent=a},l(t){l=c(t,"P",{"data-svelte-h":!0}),A(l)!=="svelte-1koprb0"&&(l.textContent=a)},m(t,i){te(t,l,i)},p:Ie,i:Ie,o:Ie,d(t){t&&d(l)}}}function Nt(n){let l,a,t,i,e="GPT Prompt",o,f,p,y,I,ne="Generate",le,P,V,T="Edit Journal Entry",w,g,E,S,Fe='<span class="label-text">Title</span>',ke,k,Ce,N,R,Oe='<span class="label-text">Slug</span>',xe,C,Le,j,B,$e='<span class="label-text">Body</span>',Pe,Y,U,Se,G,F,qe='<span class="label-text">Tags</span>',De,x,Me,O,ze="Update",Ae,K,$,ae,H,ie,ue,Ve,D,W,J,se=n[0].title+"",ce,He,re,oe=(n[0].blogSummary||"No summary available.")+"",pe,Ne,Q,q,Re,Je;U=new Ct({props:{source:n[0].body}});function Qe(m,_){return m[1]?jt:Rt}let fe=Qe(n),L=fe(n);return{c(){l=u("div"),a=u("section"),t=u("div"),i=u("h2"),i.textContent=e,o=v(),f=u("div"),p=u("textarea"),y=v(),I=u("button"),I.textContent=ne,le=v(),P=u("div"),V=u("h1"),V.textContent=T,w=v(),g=u("form"),E=u("div"),S=u("label"),S.innerHTML=Fe,ke=v(),k=u("input"),Ce=v(),N=u("div"),R=u("label"),R.innerHTML=Oe,xe=v(),C=u("input"),Le=v(),j=u("div"),B=u("label"),B.innerHTML=$e,Pe=v(),Y=u("article"),it(U.$$.fragment),Se=v(),G=u("div"),F=u("label"),F.innerHTML=qe,De=v(),x=u("input"),Me=v(),O=u("button"),O.textContent=ze,Ae=v(),K=u("aside"),$=u("div"),ae=u("figure"),H=u("img"),Ve=v(),D=u("div"),W=u("h3"),J=u("a"),ce=Be(se),He=v(),re=u("p"),pe=Be(oe),Ne=v(),Q=u("div"),L.c(),this.h()},l(m){l=c(m,"DIV",{class:!0});var _=h(l);a=c(_,"SECTION",{class:!0});var X=h(a);t=c(X,"DIV",{class:!0});var de=h(t);i=c(de,"H2",{class:!0,"data-svelte-h":!0}),A(i)!=="svelte-1wr2b2q"&&(i.textContent=e),o=b(de),f=c(de,"DIV",{class:!0});var me=h(f);p=c(me,"TEXTAREA",{class:!0,placeholder:!0}),h(p).forEach(d),y=b(me),I=c(me,"BUTTON",{class:!0,"data-svelte-h":!0}),A(I)!=="svelte-shyzxt"&&(I.textContent=ne),me.forEach(d),de.forEach(d),le=b(X),P=c(X,"DIV",{class:!0});var ge=h(P);V=c(ge,"H1",{class:!0,"data-svelte-h":!0}),A(V)!=="svelte-cnczib"&&(V.textContent=T),w=b(ge),g=c(ge,"FORM",{class:!0});var M=h(g);E=c(M,"DIV",{class:!0});var he=h(E);S=c(he,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),A(S)!=="svelte-1xyw2fh"&&(S.innerHTML=Fe),ke=b(he),k=c(he,"INPUT",{type:!0,id:!0,name:!0,class:!0,placeholder:!0}),he.forEach(d),Ce=b(M),N=c(M,"DIV",{class:!0});var _e=h(N);R=c(_e,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),A(R)!=="svelte-ijgxpj"&&(R.innerHTML=Oe),xe=b(_e),C=c(_e,"INPUT",{type:!0,id:!0,name:!0,class:!0,placeholder:!0}),_e.forEach(d),Le=b(M),j=c(M,"DIV",{class:!0});var ve=h(j);B=c(ve,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),A(B)!=="svelte-3305vn"&&(B.innerHTML=$e),Pe=b(ve),Y=c(ve,"ARTICLE",{class:!0});var Xe=h(Y);ut(U.$$.fragment,Xe),Xe.forEach(d),ve.forEach(d),Se=b(M),G=c(M,"DIV",{class:!0});var be=h(G);F=c(be,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),A(F)!=="svelte-1on1cnv"&&(F.innerHTML=qe),De=b(be),x=c(be,"INPUT",{type:!0,id:!0,name:!0,class:!0,placeholder:!0}),be.forEach(d),Me=b(M),O=c(M,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),A(O)!=="svelte-m9xsm6"&&(O.textContent=ze),M.forEach(d),ge.forEach(d),X.forEach(d),Ae=b(_),K=c(_,"ASIDE",{class:!0});var Ye=h(K);$=c(Ye,"DIV",{class:!0});var ye=h($);ae=c(ye,"FIGURE",{});var Ke=h(ae);H=c(Ke,"IMG",{src:!0,alt:!0}),Ke.forEach(d),Ve=b(ye),D=c(ye,"DIV",{class:!0});var Z=h(D);W=c(Z,"H3",{class:!0});var We=h(W);J=c(We,"A",{href:!0,class:!0});var Ze=h(J);ce=Ue(Ze,se),Ze.forEach(d),We.forEach(d),He=b(Z),re=c(Z,"P",{});var et=h(re);pe=Ue(et,oe),et.forEach(d),Ne=b(Z),Q=c(Z,"DIV",{class:!0});var tt=h(Q);L.l(tt),tt.forEach(d),Z.forEach(d),ye.forEach(d),Ye.forEach(d),_.forEach(d),this.h()},h(){s(i,"class","mb-4 text-lg font-semibold"),s(p,"class","textarea h-24 w-full"),s(p,"placeholder","Enter your GPT prompt here"),s(I,"class","btn btn-primary mt-4"),s(f,"class","form-control"),s(t,"class","border p-6"),s(V,"class","mb-4 text-xl font-semibold"),s(S,"class","label"),s(S,"for","title"),s(k,"type","text"),s(k,"id","title"),s(k,"name","title"),s(k,"class","input input-bordered w-full"),s(k,"placeholder","Your journal title"),s(E,"class","form-control w-full"),s(R,"class","label"),s(R,"for","slug"),s(C,"type","text"),s(C,"id","slug"),s(C,"name","slug"),s(C,"class","input input-bordered w-full"),s(C,"placeholder","your-journal-title"),s(N,"class","form-control w-full"),s(B,"class","label"),s(B,"for","body"),s(Y,"class","prose mx-auto text-justify lg:prose-lg"),s(j,"class","form-control w-full"),s(F,"class","label"),s(F,"for","tags"),s(x,"type","text"),s(x,"id","tags"),s(x,"name","tags"),s(x,"class","input input-bordered w-full"),s(x,"placeholder","Tags, comma separated"),s(G,"class","form-control w-full"),s(O,"type","submit"),s(O,"class","btn btn-primary"),s(g,"class","space-y-4"),s(P,"class","border p-6"),s(a,"class","space-y-6 lg:col-span-2"),at(H.src,ie=n[0].featuredImage||"https://via.placeholder.com/256x256.png?text=AI+Blog")||s(H,"src",ie),s(H,"alt",ue=n[0].title),s(J,"href","/"),s(J,"class","text-lg font-bold"),s(W,"class","card-title"),s(Q,"class","card-actions justify-end"),s(D,"class","card-body"),s($,"class","card border"),s(K,"class","space-y-4"),s(l,"class","grid gap-8 lg:grid-cols-3")},m(m,_){te(m,l,_),r(l,a),r(a,t),r(t,i),r(t,o),r(t,f),r(f,p),z(p,n[0].prompt),r(f,y),r(f,I),r(a,le),r(a,P),r(P,V),r(P,w),r(P,g),r(g,E),r(E,S),r(E,ke),r(E,k),z(k,n[0].title),r(g,Ce),r(g,N),r(N,R),r(N,xe),r(N,C),z(C,n[0].slug),r(g,Le),r(g,j),r(j,B),r(j,Pe),r(j,Y),ct(U,Y,null),r(g,Se),r(g,G),r(G,F),r(G,De),r(G,x),z(x,n[1]),r(g,Me),r(g,O),r(l,Ae),r(l,K),r(K,$),r($,ae),r(ae,H),r($,Ve),r($,D),r(D,W),r(W,J),r(J,ce),r(D,He),r(D,re),r(re,pe),r(D,Ne),r(D,Q),L.m(Q,null),q=!0,Re||(Je=[ee(p,"input",n[5]),ee(I,"click",n[6]),ee(k,"input",n[7]),ee(C,"input",n[8]),ee(x,"input",n[9]),ee(g,"submit",vt(n[2]))],Re=!0)},p(m,_){_&1&&z(p,m[0].prompt),_&1&&k.value!==m[0].title&&z(k,m[0].title),_&1&&C.value!==m[0].slug&&z(C,m[0].slug);const X={};_&1&&(X.source=m[0].body),U.$set(X),_&2&&x.value!==m[1]&&z(x,m[1]),(!q||_&1&&!at(H.src,ie=m[0].featuredImage||"https://via.placeholder.com/256x256.png?text=AI+Blog"))&&s(H,"src",ie),(!q||_&1&&ue!==(ue=m[0].title))&&s(H,"alt",ue),(!q||_&1)&&se!==(se=m[0].title+"")&&Ge(ce,se),(!q||_&1)&&oe!==(oe=(m[0].blogSummary||"No summary available.")+"")&&Ge(pe,oe),fe===(fe=Qe(m))&&L?L.p(m,_):(L.d(1),L=fe(m),L&&(L.c(),L.m(Q,null)))},i(m){q||(Te(U.$$.fragment,m),q=!0)},o(m){we(U.$$.fragment,m),q=!1},d(m){m&&d(l),pt(U),L.d(),Re=!1,bt(Je)}}}function Rt(n){let l,a="No Tags";return{c(){l=u("div"),l.textContent=a,this.h()},l(t){l=c(t,"DIV",{class:!0,"data-svelte-h":!0}),A(l)!=="svelte-15i3e2m"&&(l.textContent=a),this.h()},h(){s(l,"class","badge badge-outline")},m(t,i){te(t,l,i)},p:Ie,d(t){t&&d(l)}}}function jt(n){let l=[],a=new Map,t,i=lt(n[1].split(","));const e=o=>o[12];for(let o=0;o<i.length;o+=1){let f=ot(n,i,o),p=e(f);a.set(p,l[o]=nt(p,f))}return{c(){for(let o=0;o<l.length;o+=1)l[o].c();t=st()},l(o){for(let f=0;f<l.length;f+=1)l[f].l(o);t=st()},m(o,f){for(let p=0;p<l.length;p+=1)l[p]&&l[p].m(o,f);te(o,t,f)},p(o,f){f&2&&(i=lt(o[1].split(",")),l=dt(l,f,e,1,o,i,a,t.parentNode,mt,nt,t,ot))},d(o){o&&d(t);for(let f=0;f<l.length;f+=1)l[f].d(o)}}}function nt(n,l){let a,t=l[12].trim()+"",i;return{key:n,first:null,c(){a=u("div"),i=Be(t),this.h()},l(e){a=c(e,"DIV",{class:!0});var o=h(a);i=Ue(o,t),o.forEach(d),this.h()},h(){s(a,"class","badge badge-outline"),this.first=a},m(e,o){te(e,a,o),r(a,i)},p(e,o){l=e,o&2&&t!==(t=l[12].trim()+"")&&Ge(i,t)},d(e){e&&d(a)}}}function Bt(n){let l,a,t,i;const e=[Nt,Ht],o=[];function f(p,y){return p[0]?0:1}return a=f(n),t=o[a]=e[a](n),{c(){l=u("main"),t.c(),this.h()},l(p){l=c(p,"MAIN",{class:!0});var y=h(l);t.l(y),y.forEach(d),this.h()},h(){s(l,"class","container mx-auto my-12 px-4 sm:px-6 lg:px-8")},m(p,y){te(p,l,y),o[a].m(l,null),i=!0},p(p,y){let I=a;a=f(p),a===I?o[a].p(p,y):(It(),we(o[I],1,1,()=>{o[I]=null}),Tt(),t=o[a],t?t.p(p,y):(t=o[a]=e[a](p),t.c()),Te(t,1),t.m(l,null))},i(p){i||(Te(t),i=!0)},o(p){we(t),i=!1},d(p){p&&d(l),o[a].d()}}}function Ut(n){let l,a;return l=new At({props:{$$slots:{default:[Bt]},$$scope:{ctx:n}}}),{c(){it(l.$$.fragment)},l(t){ut(l.$$.fragment,t)},m(t,i){ct(l,t,i),a=!0},p(t,[i]){const e={};i&32771&&(e.$$scope={dirty:i,ctx:t}),l.$set(e)},i(t){a||(Te(l.$$.fragment,t),a=!0)},o(t){we(l.$$.fragment,t),a=!1},d(t){pt(l,t)}}}function Gt(n,l,a){let t,i;ht(n,wt,T=>a(4,i=T));let e,o="";console.log("Received slug:",t),_t(async()=>{try{a(0,e=await kt(t)),e?a(1,o=e.tags?e.tags.join(", "):""):console.log("Post not found")}catch(T){console.error("Error fetching post:",T)}});async function f(T){if(T.preventDefault(),!e)return;const w=o.split(",").map(E=>E.trim()).filter(E=>E.length>0),g={...e,title:e.title,slug:e.slug,body:e.body,blogSummary:e.blogSummary,prompt:e.prompt,featuredImage:e.featuredImage};await rt(e.id,g),await p(e.id,w),ft(`/posts/${e.slug}`)}async function p(T,w){const g=await xt(w);await rt(T,{tags:g})}async function y(T){if(T.length===0){alert("Please enter a prompt to generate from.");return}else if(!e)return;a(0,e.prompt=T,e);const w=await Ee(Lt+"This is the user's inspiration: '"+e.prompt+"'");a(0,e.body=w,e);const g=await Ee(St+"This is the user's article: '"+w+"'");a(0,e.title=g.replace(/["']/g,""),e),a(0,e.slug=g.toLowerCase().replace(/\s+/g,"-").replace(/["':]/g,"").substring(0,50),e);const E=await Ee(Dt+"This is the blog article: '"+w+"'");a(0,e.tags=[E],e);const S=await Ee(Mt+"This is the blog article: '"+w+"'");return a(0,e.blogSummary=S,e),await Pt(g+"  "+E),{title:e.title,slug:e.slug,body:e.body,blogSummary:e.blogSummary,userid:e.userid,tags:e.tags,featuredImage:e.featuredImage}}function I(){e.prompt=this.value,a(0,e)}const ne=()=>y((e==null?void 0:e.prompt)??"");function le(){e.title=this.value,a(0,e)}function P(){e.slug=this.value,a(0,e)}function V(){o=this.value,a(1,o)}return n.$$.update=()=>{n.$$.dirty&16&&(t=i.params.slug)},[e,o,f,y,i,I,ne,le,P,V]}class Wt extends yt{constructor(l){super(),Et(this,l,Gt,Ut,gt,{})}}export{Wt as component,Kt as universal};
